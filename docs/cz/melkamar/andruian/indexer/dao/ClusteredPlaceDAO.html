<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_171) on Fri Apr 20 18:07:34 CEST 2018 -->
<title>ClusteredPlaceDAO (indexer2 1.0.0 API)</title>
<meta name="date" content="2018-04-20">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ClusteredPlaceDAO (indexer2 1.0.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusterQueryBuilder.html" title="class in cz.melkamar.andruian.indexer.dao"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html" target="_top">Frames</a></li>
<li><a href="ClusteredPlaceDAO.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">cz.melkamar.andruian.indexer.dao</div>
<h2 title="Class ClusteredPlaceDAO" class="title">Class ClusteredPlaceDAO</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>cz.melkamar.andruian.indexer.dao.ClusteredPlaceDAO</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@Component
public class <span class="typeNameLabel">ClusteredPlaceDAO</span>
extends java.lang.Object</pre>
<div class="block">A Data Access Object for retrieving clusters of places from the index database.

 The clustering functionality is implemented by the Solr database as heatmaps. The geospatial size
 of a cluster depends on the size of the area the clusters are formed from. The number of cells the
 given area is divided into should be roughly the same, regardless of the zoom level.

 If no area is provided, it defaults to encompass the whole world.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#ClusteredPlaceDAO-cz.melkamar.andruian.indexer.net.NetHelper-cz.melkamar.andruian.indexer.config.IndexerConfiguration-">ClusteredPlaceDAO</a></span>(<a href="../../../../../cz/melkamar/andruian/indexer/net/NetHelper.html" title="class in cz.melkamar.andruian.indexer.net">NetHelper</a>&nbsp;netHelper,
                 <a href="../../../../../cz/melkamar/andruian/indexer/config/IndexerConfiguration.html" title="class in cz.melkamar.andruian.indexer.config">IndexerConfiguration</a>&nbsp;configuration)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../cz/melkamar/andruian/indexer/Util.LatLng.html" title="class in cz.melkamar.andruian.indexer">Util.LatLng</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#calculateClusterPosition-int-int-cz.melkamar.andruian.indexer.Util.Rect-int-int-">calculateClusterPosition</a></span>(int&nbsp;columns,
                        int&nbsp;rows,
                        <a href="../../../../../cz/melkamar/andruian/indexer/Util.Rect.html" title="class in cz.melkamar.andruian.indexer">Util.Rect</a>&nbsp;boundingRect,
                        int&nbsp;colIdx,
                        int&nbsp;rowIdx)</code>
<div class="block">Calculates the position of the center of a grid cell, given the grid bounding rectangle coordinates, the
 number of rows and columns and the row/col index of the cell.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#getAllPlaces--">getAllPlaces</a></span>()</code>
<div class="block">Get all places indexed in the system as clusters.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#getPlacesAroundPoint-double-double-double-">getPlacesAroundPoint</a></span>(double&nbsp;latCoord,
                    double&nbsp;longCoord,
                    double&nbsp;radius)</code>
<div class="block">Get places inside an area defined by the coordinates as clusters.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#getPlacesAroundPointOfClass-java.lang.String-double-double-double-">getPlacesAroundPointOfClass</a></span>(java.lang.String&nbsp;classUri,
                           double&nbsp;latCoord,
                           double&nbsp;longCoord,
                           double&nbsp;radius)</code>
<div class="block">Get places inside an area defined by the coordinates, of a particular RDF class, as clusters.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#getPlacesOfClass-java.lang.String-">getPlacesOfClass</a></span>(java.lang.String&nbsp;classUri)</code>
<div class="block">Get all places of the given RDF class indexed in the system as clusters.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#parseClusterQueryResponse-java.lang.String-">parseClusterQueryResponse</a></span>(java.lang.String&nbsp;response)</code>
<div class="block">Parse the response of a cluster/heatmap query from Solr.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ClusteredPlaceDAO-cz.melkamar.andruian.indexer.net.NetHelper-cz.melkamar.andruian.indexer.config.IndexerConfiguration-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ClusteredPlaceDAO</h4>
<pre>@Autowired
public&nbsp;ClusteredPlaceDAO(<a href="../../../../../cz/melkamar/andruian/indexer/net/NetHelper.html" title="class in cz.melkamar.andruian.indexer.net">NetHelper</a>&nbsp;netHelper,
                                     <a href="../../../../../cz/melkamar/andruian/indexer/config/IndexerConfiguration.html" title="class in cz.melkamar.andruian.indexer.config">IndexerConfiguration</a>&nbsp;configuration)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getAllPlaces--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllPlaces</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;&nbsp;getAllPlaces()</pre>
<div class="block">Get all places indexed in the system as clusters.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A list of <a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place"><code>PlaceCluster</code></a> representing the matching data.</dd>
</dl>
</li>
</ul>
<a name="getPlacesOfClass-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPlacesOfClass</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;&nbsp;getPlacesOfClass(java.lang.String&nbsp;classUri)</pre>
<div class="block">Get all places of the given RDF class indexed in the system as clusters.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>classUri</code> - The IRI of a RDF class to search for.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A list of <a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place"><code>PlaceCluster</code></a> representing the matching data.</dd>
</dl>
</li>
</ul>
<a name="getPlacesAroundPoint-double-double-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPlacesAroundPoint</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;&nbsp;getPlacesAroundPoint(double&nbsp;latCoord,
                                                         double&nbsp;longCoord,
                                                         double&nbsp;radius)</pre>
<div class="block">Get places inside an area defined by the coordinates as clusters.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>latCoord</code> - The latitude of the center of the area to search in.</dd>
<dd><code>longCoord</code> - The longitude of the center of the area to search in.</dd>
<dd><code>radius</code> - The radius from the center of the area to search in, in kilometers.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A list of <a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place"><code>PlaceCluster</code></a> representing the matching data.</dd>
</dl>
</li>
</ul>
<a name="getPlacesAroundPointOfClass-java.lang.String-double-double-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPlacesAroundPointOfClass</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;&nbsp;getPlacesAroundPointOfClass(java.lang.String&nbsp;classUri,
                                                                double&nbsp;latCoord,
                                                                double&nbsp;longCoord,
                                                                double&nbsp;radius)</pre>
<div class="block">Get places inside an area defined by the coordinates, of a particular RDF class, as clusters.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>classUri</code> - The IRI of a RDF class to search for.</dd>
<dd><code>latCoord</code> - The latitude of the center of the area to search in.</dd>
<dd><code>longCoord</code> - The longitude of the center of the area to search in.</dd>
<dd><code>radius</code> - The radius from the center of the area to search in, in kilometers.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A list of <a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place"><code>PlaceCluster</code></a> representing the matching data.</dd>
</dl>
</li>
</ul>
<a name="parseClusterQueryResponse-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseClusterQueryResponse</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place">PlaceCluster</a>&gt;&nbsp;parseClusterQueryResponse(java.lang.String&nbsp;response)</pre>
<div class="block">Parse the response of a cluster/heatmap query from Solr. An example of the query format is provided
 in the test class ClusteredPlaceDAOTest.

 The response does not directly return GPS locations of the clusters. Instead, it divides the rectangle
 that is being searched into an orthogonal grid and returns the number of columns and rows of such grid.
 The grid of clusters is then represented as a 2D array of numbers, each number specifying how many clusters
 belong to each of the grid cells. The method <a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#calculateClusterPosition-int-int-cz.melkamar.andruian.indexer.Util.Rect-int-int-"><code>calculateClusterPosition(int, int, Util.Rect, int, int)</code></a>
 is used to calculate the GPS position of the center of each grid cell (and effectively the approximate location
 of the place cluster it represents).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>response</code> - The query JSON response.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A parsed list of <a href="../../../../../cz/melkamar/andruian/indexer/model/place/PlaceCluster.html" title="class in cz.melkamar.andruian.indexer.model.place"><code>PlaceCluster</code></a> objects.</dd>
</dl>
</li>
</ul>
<a name="calculateClusterPosition-int-int-cz.melkamar.andruian.indexer.Util.Rect-int-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>calculateClusterPosition</h4>
<pre>public&nbsp;<a href="../../../../../cz/melkamar/andruian/indexer/Util.LatLng.html" title="class in cz.melkamar.andruian.indexer">Util.LatLng</a>&nbsp;calculateClusterPosition(int&nbsp;columns,
                                            int&nbsp;rows,
                                            <a href="../../../../../cz/melkamar/andruian/indexer/Util.Rect.html" title="class in cz.melkamar.andruian.indexer">Util.Rect</a>&nbsp;boundingRect,
                                            int&nbsp;colIdx,
                                            int&nbsp;rowIdx)</pre>
<div class="block">Calculates the position of the center of a grid cell, given the grid bounding rectangle coordinates, the
 number of rows and columns and the row/col index of the cell. For more explanation why, refer to the
 <a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html#parseClusterQueryResponse-java.lang.String-"><code>parseClusterQueryResponse(String)</code></a> method.

 The algorithm is straightforward - split the rectangle evenly to form a grid, find the coordinates of the edge
 of the cell we are looking for and add half of the cell's width/height to find its center.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>columns</code> - The number of columns the grid contains.</dd>
<dd><code>rows</code> - The number of rows the grid contains.</dd>
<dd><code>boundingRect</code> - The bounding rectangle of the whole grid. The rectangle is orthogonal and defined by the
                     bottom-leftmost and top-rightmost points.</dd>
<dd><code>colIdx</code> - The column index of the cell in the grid for which to calculate the position. 0-indexed.</dd>
<dd><code>rowIdx</code> - The row index of the cell in the grid for which to calculate the position. 0-indexed.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The latitude and longitude of the center of the given grid cell.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../cz/melkamar/andruian/indexer/dao/ClusterQueryBuilder.html" title="class in cz.melkamar.andruian.indexer.dao"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?cz/melkamar/andruian/indexer/dao/ClusteredPlaceDAO.html" target="_top">Frames</a></li>
<li><a href="ClusteredPlaceDAO.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
